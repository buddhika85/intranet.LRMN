@model IEnumerable<Persistance.DomainModel.ApplicationUser>
@{
    ViewBag.Title = "ManageContacts";
}

<h2>Manage Contacts</h2>
<table id="contactsTbl" class="table table-bordered table-responsive"></table>

@section scripts {

    <script type="text/javascript">

        $(document).ready(function () {            
            $.ajax({
                url: '/API/ManageContactsAPI',
                method: 'GET',
                data: null,
                cache: false,
                async: false,
                success: function (result) {                    
                    drawContactsTable(result);
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {                    
                    bootbox.alert({
                        title: "<span class='text-danger'><strong>Error</strong></span>",
                        message: "Unabled to retrieve contacts" + " - Please contact IT support"
                    });                                   
                }
            });

        });

        // draw data table
        function drawContactsTable(contacts) {
            $("#contactsTbl").dataTable(
                {
                    "data": contacts,
                    "aoColumns": [
                            { "mData": "UserIdGenerated", "sTitle": "ID", "bVisible": true },
                            { "mData": "UserId", "sTitle": "UserId", "bVisible": false },
                            { "mData": "Email", "sTitle": "Email/Username", "bVisible": true },
                            { "mData": "FirstName", "sTitle": "First Name", "bVisible": true },
                            { "mData": "LastName", "sTitle": "Last Name", "bVisible": true },
                            { "mData": "PhoneNumber", "sTitle": "Phone", "bVisible": true },
                            { "mData": "JoinDate", "sTitle": "Joined", "bVisible": true },
                            { "mData": "ContractEndDate", "sTitle": "Contract Ends", "bVisible": true },
                            { "mData": "UserActive", "sTitle": "Activated", "bVisible": true },
                            { "mData": "UserLocked", "sTitle": "Locked", "bVisible": true },
                            { "mData": "RoleName", "sTitle": "Role", "bVisible": true },
                            { "mData": "ContactType", "sTitle": "Contact Type", "bVisible": true },
                            { "mData": "AccessFailedCount", "sTitle": "Access Failed Count", "bVisible": true },
                    ]
                }
            );
        }

    </script>
}

